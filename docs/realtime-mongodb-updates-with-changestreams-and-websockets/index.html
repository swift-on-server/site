<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="utf-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="canonical" href="https://swiftonserver.com/realtime-mongodb-updates-with-changestreams-and-websockets/">
    <link rel="prev" href="https://swiftonserver.com/advanced-async-sequences/">
    <link rel="next" href="https://swiftonserver.com/hummingbird-and-cors/">

    <title>Realtime MongoDB Updates with ChangeStreams and WebSockets - Swift on server</title>
    <meta name="description" content="Learn how to implement real-time updates over WebSockets using ChangeStreams and MongoKitten">

    <meta property="og:url" content="https://swiftonserver.com/realtime-mongodb-updates-with-changestreams-and-websockets/">
    <meta property="og:title" content="Realtime MongoDB Updates with ChangeStreams and WebSockets - Swift on server">
    <meta property="og:description" content="Learn how to implement real-time updates over WebSockets using ChangeStreams and MongoKitten">
    <meta property="og:image" content="https://swiftonserver.com/assets/realtime-mongodb-updates-with-changestreams-and-websockets/cover.jpg" />

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Realtime MongoDB Updates with ChangeStreams and WebSockets - Swift on server">
    <meta name="twitter:description" content="Learn how to implement real-time updates over WebSockets using ChangeStreams and MongoKitten">
    <meta name="twitter:image" content="https://swiftonserver.com/assets/realtime-mongodb-updates-with-changestreams-and-websockets/cover.jpg">

    <link rel="stylesheet" href="https://swiftonserver.com/css/modern-normalize.css">
    <link rel="stylesheet" href="https://swiftonserver.com/css/modern-base.css">
    <link rel="stylesheet" href="https://swiftonserver.com/css/variables.css">
    <link rel="stylesheet" href="https://swiftonserver.com/css/base.css">
    <link rel="stylesheet" href="https://swiftonserver.com/css/grid.css">
    <link rel="stylesheet" href="https://swiftonserver.com/css/navigation.css">
    <link rel="stylesheet" href="https://swiftonserver.com/css/footer.css">
    <link rel="stylesheet" href="https://swiftonserver.com/css/syntax.css">
    <link rel="stylesheet" href="https://swiftonserver.com/css/style.css">

    

    <link rel="shortcut icon" href="https://swiftonserver.com/images/icons/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="https://swiftonserver.com/images/icons/icon-320.png" type="image/png">
    
    <link rel="apple-touch-icon" href="https://swiftonserver.com/images/icons/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="57x57" href="https://swiftonserver.com/images/icons/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="72x72" href="https://swiftonserver.com/images/icons/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="https://swiftonserver.com/images/icons/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="https://swiftonserver.com/images/icons/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="https://swiftonserver.com/images/icons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="https://swiftonserver.com/images/icons/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="https://swiftonserver.com/images/icons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://swiftonserver.com/images/icons/apple-touch-icon-180x180.png">

    <link
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css"
        media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">
    <link
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css"
        media="(prefers-color-scheme: dark)"
    >

    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
          const container = document.querySelector("div#swiftinit-tooltips");
          if (container !== null) {
              container.querySelectorAll('pre code').forEach((el) => {
                  el.classList.add('nohighlight');
              });
          }
        });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
          document.querySelectorAll('section pre code:not(.language-swift').forEach((el) => {
              hljs.highlightElement(el);
          });
        });
    </script>

    <script defer data-domain="swiftonserver.com" src="https://plausible.io/js/script.js"></script>

</head>

<body>
    <div id="site-container">

    <header id="navigation">
        <a href="/">
            <figure>
                <picture>
                    <source
                        srcset="https://swiftonserver.com/logos/logo~dark.png"
                        media="(prefers-color-scheme: dark)"
                    >
                    <img
                        src="https://swiftonserver.com/images/logos/logo.png"
                        alt="Logo of Swift on server"
                        title="Swift on server"
                    >
                </picture>
            </figure>
        </a>
        <nav>
            <input type="checkbox" id="primary-menu-button" name="menu-button" class="menu-button">
            <label for="primary-menu-button">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="3" y1="12" x2="21" y2="12"></line>
                    <line x1="3" y1="6" x2="21" y2="6"></line>
                    <line x1="3" y1="18" x2="21" y2="18"></line>
                </svg>
            </label>
            <div class="menu-items">
                <a href="/posts/page/1/">Posts</a>
            <a href="/tags/">Tags</a>
            <a href="/authors/">Authors</a>
            <a href="/newsletter/">Newsletter</a>
            </div>
        </nav>
    </header>

    <main id="page-container">
    
    <div class="article-with-toc">
        <div>
            <article class="post">
                <div class="meta">
                    <time datetime="2024-12-28">2024-12-28</time>
                     &middot; <span class="reading-time">8 min read</span>
                    
                </div>
                <section>
                
                <section class='introduction'><h1>Real-time MongoDB Updates over WebSockets</h1></section><section class='details literature'><p>Learn how to create a real-time feed of MongoDB changes using ChangeStreams and WebSockets. This tutorial demonstrates how to stream database changes to connected clients using MongoKitten and Hummingbird.</p><h2 id='Overview'><a href='#Overview'>Overview</a></h2><p>In this tutorial, you’ll learn how to:</p><ul><li><p>Create a real-time post feed using MongoDB ChangeStreams</p></li><li><p>Set up a WebSocket server with Hummingbird</p></li><li><p>Implement a REST endpoint for creating posts</p></li><li><p>Broadcast changes to WebSocket clients</p></li><li><p>Handle WebSocket connections safely using Swift concurrency</p></li></ul><h3 id='Prerequisites'><a href='#Prerequisites'>Prerequisites</a></h3><p>This tutorial builds upon concepts from:</p><ul><li><p><a href='../getting-started-with-mongokitten'>Getting Started with MongoDB in Swift using MongoKitten</a></p></li><li><p><a href='../websockets-tutorial-using-swift-and-hummingbird'>WebSocket tutorial using Swift and Hummingbird</a></p></li></ul><p>Make sure you have MongoDB running locally before starting.</p><h2 id='The%20Connection%20Manager'><a href='#The%20Connection%20Manager'>The Connection Manager</a></h2><p>The <code>ConnectionManager</code> handles WebSocket connections and MongoDB change notifications:</p><pre class='snippet'><code class='language-swift'><span class='newline'></span><span class='xk'>actor</span> <span class='xt'>ConnectionManager</span> {<span class='newline'>
</span>    <span class='xk'>private</span> <span class='xk'>let</span> <span class='xv'>database</span>: <a class='xt' href='https://swiftinit.org/hist/mongokitten:7.9.8/mongokitten/mongodatabase' target='_blank' rel='external'>MongoDatabase</a><span class='newline'>
</span>    <span class='xk'>private</span> <span class='xk'>var</span> <span class='xv'>outboundConnections</span>: [<a class='xt' href='https://swiftinit.org/docs/swift/foundationessentials/uuid' target='_blank' rel='external'>UUID</a>: <a class='xt' href='https://swiftinit.org/hist/swift-websocket:1.2.1/wscore/websocketoutboundwriter' target='_blank' rel='external'>WebSocketOutboundWriter</a>] = [:]<span class='newline'>
</span>    <span class='newline'>
</span>    <span class='xk'>init</span>(<span class='xv'>database</span>: <a class='xt' href='https://swiftinit.org/hist/mongokitten:7.9.8/mongokitten/mongodatabase' target='_blank' rel='external'>MongoDatabase</a>) {<span class='newline'>
</span>        <span class='xk'>self</span>.<span class='xv'>database</span> = <span class='xv'>database</span><span class='newline'>
</span>    }<span class='newline'>
</span>    <span class='newline'>
</span>    <span class='xk'>func</span> <span class='xv'>broadcast</span>(_ <span class='xv'>data</span>: <a class='xt' href='https://swiftinit.org/docs/swift/foundationessentials/data' target='_blank' rel='external'>Data</a>) <span class='xk'>async</span> {<span class='newline'>
</span>        <span class='xk'>guard</span> <span class='xk'>let</span> <span class='xv'>text</span> = <a class='xt' href='https://swiftinit.org/docs/swift/swift/string' target='_blank' rel='external'>String</a>(<span class='xv'>data</span>: <span class='xv'>data</span>, <span class='xv'>encoding</span>: .<a class='xv' href='https://swiftinit.org/docs/swift/swift/string/encoding.utf8' target='_blank' rel='external'>utf8</a>) <span class='xk'>else</span> {<span class='newline'>
</span>            <span class='xk'>return</span><span class='newline'>
</span>        }<span class='newline'>
</span>        <span class='newline'>
</span>        <span class='xk'>for</span> <span class='xv'>connection</span> <span class='xk'>in</span> <span class='xv'>outboundConnections</span>.<a class='xv' href='https://swiftinit.org/docs/swift/swift/dictionary.values' target='_blank' rel='external'>values</a> {<span class='newline'>
</span>            <span class='xk'>try</span>? <span class='xk'>await</span> <span class='xv'>connection</span>.<a class='xv' href='https://swiftinit.org/hist/swift-websocket:1.2.1/wscore/websocketoutboundwriter.write(_:)' target='_blank' rel='external'>write</a>(.<a class='xv' href='https://swiftinit.org/hist/swift-websocket:1.2.1/wscore/websocketoutboundwriter/outboundframe.text(_:)' target='_blank' rel='external'>text</a>(<span class='xv'>text</span>))<span class='newline'>
</span>        }<span class='newline'>
</span>    }<span class='newline'>

</span>    <span class='xk'>func</span> <span class='xv'>withRegisteredClient</span>&lt;<span class='xv'>T</span>: <a class='xt' href='https://swiftinit.org/docs/swift/swift/sendable' target='_blank' rel='external'>Sendable</a>&gt;(<span class='newline'>
</span>        _ <span class='xv'>client</span>: <a class='xt' href='https://swiftinit.org/hist/swift-websocket:1.2.1/wscore/websocketoutboundwriter' target='_blank' rel='external'>WebSocketOutboundWriter</a>,<span class='newline'>
</span>        <span class='xv'>perform</span>: () <span class='xk'>async</span> <span class='xk'>throws</span> -&gt; <span class='xt'>T</span><span class='newline'>
</span>    ) <span class='xk'>async</span> <span class='xk'>throws</span> -&gt; <span class='xt'>T</span> {<span class='newline'>
</span>        <span class='xk'>let</span> <span class='xv'>id</span> = <a class='xt' href='https://swiftinit.org/docs/swift/foundationessentials/uuid' target='_blank' rel='external'>UUID</a>()<span class='newline'>
</span>        <span class='xv'>outboundConnections</span><a href='https://swiftinit.org/docs/swift/swift/dictionary.subscript(_:)?hash=8RFQL' target='_blank' rel='external'>[</a><span class='xv'>id</span>] = <span class='xv'>client</span><span class='newline'>
</span>        <span class='xk'>defer</span> { <span class='xv'>outboundConnections</span><a href='https://swiftinit.org/docs/swift/swift/dictionary.subscript(_:)?hash=8RFQL' target='_blank' rel='external'>[</a><span class='xv'>id</span>] = <span class='xk'>nil</span> }<span class='newline'>
</span>        <span class='xk'>return</span> <span class='xk'>try</span> <span class='xk'>await</span> <span class='xv'>perform</span>()<span class='newline'>
</span>    }<span class='newline'>
</span>}</code></pre><a rel='ugc' href='https://github.com/swift-on-server/articles/blob/main/Snippets/realtime-mongodb-app.swift#L85' target='_blank' class='source github'><span class='file'>realtime-mongodb-app.swift</span>:<span class='line'>85</span></a><ol><li><p>The manager is an actor to ensure thread-safe access to connections</p></li><li><p>It maintains a dictionary of active WebSocket connections</p></li><li><p>The <code>broadcast</code> method sends updates to all connected clients</p></li><li><p><code>withRegisteredClient</code> safely manages client lifecycle using structured concurrency</p></li></ol><p>The use of <code>withRegisteredClient</code> ensures that the WebSocket connection is properly cleaned up when the connection is closed. This pattern is very scalable.</p><aside class='tip'><h3>Tip</h3><p>Watch <a href='https://www.youtube.com/watch?v=JmrnE7HUaDE' target='_blank' rel='external nofollow noopener ugc'>Franz’ Busch talk</a> on this topic for a deeper dive into this pattern.</p></aside><h3 id='Watching%20for%20Changes'><a href='#Watching%20for%20Changes'>Watching for Changes</a></h3><p>Now that the <code>ConnectionManager</code> is implemented, we can watch for changes in the MongoDB database. For this, we’ll tie the <code>ConnectionManager</code> to the application lifecycle using the <code><a href='https://swiftinit.org/hist/swift-service-lifecycle:2.6.3/servicelifecycle/service' target='_blank' rel='external'>Service</a></code> protocol.</p><pre class='snippet'><code class='language-swift'><span class='newline'></span><span class='xk'>extension</span> <span class='xt'>ConnectionManager</span>: <a class='xt' href='https://swiftinit.org/hist/swift-service-lifecycle:2.6.3/servicelifecycle/service' target='_blank' rel='external'>Service</a> {<span class='newline'>
</span>    <span class='xk'>func</span> <span class='xv'>run</span>() <span class='xk'>async</span> <span class='xk'>throws</span> {<span class='newline'>
</span>        <span class='xc'>// 1.</span><span class='newline'>
</span>        <span class='xk'>let</span> <span class='xv'>posts</span> = <span class='xv'>database</span><a href='https://swiftinit.org/hist/mongokitten:7.9.8/mongokitten/mongodatabase.subscript(_:)' target='_blank' rel='external'>[</a><span class='xs'>"posts"</span>]<span class='newline'>
</span>        <span class='newline'>
</span>        <span class='xc'>// 2.</span><span class='newline'>
</span>        <span class='xk'>let</span> <span class='xv'>changes</span> = <span class='xk'>try</span> <span class='xk'>await</span> <span class='xv'>posts</span>.<a class='xv' href='https://swiftinit.org/hist/mongokitten:7.9.8/mongokitten/mongocollection.watch(options:type:using:)' target='_blank' rel='external'>watch</a>(<span class='xv'>type</span>: <span class='xt'>Post</span>.<span class='xk'>self</span>)<span class='newline'>
</span>        <span class='newline'>
</span>        <span class='xc'>// 3.</span><span class='newline'>
</span>        <span class='xk'>for</span> <span class='xk'>try</span> <span class='xk'>await</span> <span class='xv'>change</span> <span class='xk'>in</span> <span class='xv'>changes</span> {<span class='newline'>
</span>            <span class='xc'>// 4.</span><span class='newline'>
</span>            <span class='xk'>if</span> <span class='xv'>change</span>.<a class='xv' href='https://swiftinit.org/hist/mongokitten:7.9.8/mongokitten/changestreamnotification.operationtype' target='_blank' rel='external'>operationType</a> <a class='xv' href='https://swiftinit.org/docs/swift/swift.==(_:_:)?hash=9HU5C' target='_blank' rel='external'>==</a> .<a class='xv' href='https://swiftinit.org/hist/mongokitten:7.9.8/mongokitten/changestreamnotification/operationtype.insert' target='_blank' rel='external'>insert</a>, <span class='xk'>let</span> <span class='xv'>post</span> = <span class='xv'>change</span>.<a class='xv' href='https://swiftinit.org/hist/mongokitten:7.9.8/mongokitten/changestreamnotification.fulldocument' target='_blank' rel='external'>fullDocument</a> {<span class='newline'>
</span>                <span class='xc'>// 5.</span><span class='newline'>
</span>                <span class='xk'>let</span> <span class='xv'>jsonData</span> = <span class='xk'>try</span> <a class='xt' href='https://swiftinit.org/docs/swift/foundationessentials/jsonencoder' target='_blank' rel='external'>JSONEncoder</a>().<a class='xv' href='https://swiftinit.org/docs/swift/foundationessentials/jsonencoder.encode(_:)' target='_blank' rel='external'>encode</a>(<span class='xv'>post</span>)<span class='newline'>
</span>                <span class='xc'>// 6.</span><span class='newline'>
</span>                <span class='xk'>await</span> <span class='xv'>broadcast</span>(<span class='xv'>jsonData</span>)<span class='newline'>
</span>            }<span class='newline'>
</span>        }<span class='newline'>
</span>    }<span class='newline'>
</span>}</code></pre><a rel='ugc' href='https://github.com/swift-on-server/articles/blob/main/Snippets/realtime-mongodb-app.swift#L116' target='_blank' class='source github'><span class='file'>realtime-mongodb-app.swift</span>:<span class='line'>116</span></a><ol><li><p>Get a reference to the posts collection</p></li><li><p>Create a change stream watching for post changes</p></li><li><p>Loop over each change</p></li><li><p>If the change is an insert, take the decoded post</p></li><li><p>Encode the post as JSON</p></li><li><p>Broadcast the post to all connected clients</p></li></ol><p>This flow is very scalable, as only one ChangeStream is created and maintained per Hummingbird instance. At the same time, the use of structured concurrency ensures that the ChangeStream is properly cleaned up when the application shuts down.</p><h2 id='Setting%20Up%20the%20Application'><a href='#Setting%20Up%20the%20Application'>Setting Up the Application</a></h2><p>Let’s create the main application entry point:</p><pre class='snippet'><code class='language-swift'><span class='newline'></span><span class='xa'>@main</span><span class='newline'>
</span><span class='xk'>struct</span> <span class='xt'>RealtimeMongoApp</span> {<span class='newline'>
</span>    <span class='xk'>static</span> <span class='xk'>func</span> <span class='xv'>main</span>() <span class='xk'>async</span> <span class='xk'>throws</span> {<span class='newline'>
</span>        <span class='xc'>// 1.</span><span class='newline'>
</span>        <span class='xk'>let</span> <span class='xv'>db</span> = <span class='xk'>try</span> <span class='xk'>await</span> <a class='xt' href='https://swiftinit.org/hist/mongokitten:7.9.8/mongokitten/mongodatabase' target='_blank' rel='external'>MongoDatabase</a>.<a class='xv' href='https://swiftinit.org/hist/mongokitten:7.9.8/mongokitten/mongodatabase.connect(to:logger:)?hash=33E0S' target='_blank' rel='external'>connect</a>(<span class='xv'>to</span>: <span class='xs'>"mongodb://localhost/social_network"</span>)<span class='newline'>
</span>        <span class='newline'>
</span>        <span class='xc'>// 2.</span><span class='newline'>
</span>        <span class='xk'>let</span> <span class='xv'>connectionManager</span> = <span class='xt'>ConnectionManager</span>(<span class='xv'>database</span>: <span class='xv'>db</span>)<span class='newline'>


</span>        <span class='xk'>let</span> <span class='xv'>router</span> = <a class='xt' href='https://swiftinit.org/hist/hummingbird:2.6.2/hummingbird/router' target='_blank' rel='external'>Router</a>(<span class='xv'>context</span>: <a class='xt' href='https://swiftinit.org/hist/hummingbird:2.6.2/hummingbird/basicrequestcontext' target='_blank' rel='external'>BasicRequestContext</a>.<span class='xk'>self</span>)<span class='newline'>
</span>        <span class='xv'>setupRoutes</span>(<span class='xv'>router</span>: <span class='xv'>router</span>, <span class='xv'>db</span>: <span class='xv'>db</span>)<span class='newline'>
</span>        <span class='newline'>
</span>        <span class='xc'>// 4.</span><span class='newline'>
</span>        <span class='xk'>var</span> <span class='xv'>app</span> = <a class='xt' href='https://swiftinit.org/hist/hummingbird:2.6.2/hummingbird/application' target='_blank' rel='external'>Application</a>(<span class='newline'>
</span>            <span class='xv'>router</span>: <span class='xv'>router</span>,<span class='newline'>
</span>            <span class='xv'>server</span>: .<a class='xv' href='https://swiftinit.org/docs/hummingbird-websocket/hummingbirdcore/httpserverbuilder.http1websocketupgrade(configuration:additionalchannelhandlers:shouldupgrade:)?hash=6SIVA' target='_blank' rel='external'>http1WebSocketUpgrade</a> { <span class='xv'>request</span>, <span class='xv'>channel</span>, <span class='xv'>logger</span> <span class='xk'>in</span><span class='newline'>
</span>                <span class='xk'>return</span> .<a class='xv' href='https://swiftinit.org/docs/hummingbird-websocket/hummingbirdwebsocket/shouldupgraderesult.upgrade(_:_:)' target='_blank' rel='external'>upgrade</a>([:]) { <span class='xv'>inbound</span>, <span class='xv'>outbound</span>, <span class='xv'>context</span> <span class='xk'>in</span><span class='newline'>
</span>                    <span class='xk'>try</span> <span class='xk'>await</span> <span class='xv'>connectionManager</span>.<span class='xv'>withRegisteredClient</span>(<span class='xv'>outbound</span>) {<span class='newline'>
</span>                        <span class='xk'>for</span> <span class='xk'>try</span> <span class='xk'>await</span> _ <span class='xk'>in</span> <span class='xv'>inbound</span> {<span class='newline'>
</span>                            <span class='xc'>// Drop any incoming data, we don't need it</span><span class='newline'>
</span>                            <span class='xc'>// But keep the connection open</span><span class='newline'>
</span>                        }<span class='newline'>
</span>                    }<span class='newline'>
</span>                }<span class='newline'>
</span>            }<span class='newline'>
</span>        )<span class='newline'>

</span>        <span class='xc'>// 5.</span><span class='newline'>
</span>        <span class='xv'>app</span>.<a class='xv' href='https://swiftinit.org/hist/hummingbird:2.6.2/hummingbird/application.addservices(_:)' target='_blank' rel='external'>addServices</a>(<span class='xv'>connectionManager</span>)<span class='newline'>
</span>        <span class='newline'>
</span>        <span class='xc'>// 6.</span><span class='newline'>
</span>        <span class='xk'>try</span> <span class='xk'>await</span> <span class='xv'>app</span>.<a class='xv' href='https://swiftinit.org/hist/hummingbird:2.6.2/hummingbird/applicationprotocol.runservice(gracefulshutdownsignals:)' target='_blank' rel='external'>runService</a>()<span class='newline'>
</span>    }<span class='newline'>
</span>}</code></pre><a rel='ugc' href='https://github.com/swift-on-server/articles/blob/main/Snippets/realtime-mongodb-app.swift#L47' target='_blank' class='source github'><span class='file'>realtime-mongodb-app.swift</span>:<span class='line'>47</span></a><ol><li><p>Connect to MongoDB</p></li><li><p>Create the connection manager</p></li><li><p>Setup the HTTP router with a POST endpoint for creating posts</p></li><li><p>Configure WebSocket support using HTTP/1.1 upgrade</p></li><li><p>Add the connection manager as a service</p></li><li><p>Run the application</p></li></ol><h3 id='Adding%20Routes'><a href='#Adding%20Routes'>Adding Routes</a></h3><pre class='snippet'><code class='language-swift'><span class='newline'></span><span class='xk'>func</span> <span class='xv'>setupRoutes</span>(<span class='xv'>router</span>: <a class='xt' href='https://swiftinit.org/hist/hummingbird:2.6.2/hummingbird/router' target='_blank' rel='external'>Router</a>&lt;<a class='xt' href='https://swiftinit.org/hist/hummingbird:2.6.2/hummingbird/basicrequestcontext' target='_blank' rel='external'>BasicRequestContext</a>&gt;, <span class='xv'>db</span>: <a class='xt' href='https://swiftinit.org/hist/mongokitten:7.9.8/mongokitten/mongodatabase' target='_blank' rel='external'>MongoDatabase</a>) {<span class='newline'>
</span>    <span class='xv'>router</span>.<a class='xv' href='https://swiftinit.org/hist/hummingbird:2.6.2/hummingbird/routermethods.post(_:use:)' target='_blank' rel='external'>post</a>(<a class='xs' href='https://swiftinit.org/hist/hummingbird:2.6.2/hummingbird/routerpath.init(stringliteral:)' target='_blank' rel='external'>"/posts"</a>) { <span class='xv'>request</span>, <span class='xv'>context</span> -&gt; <a class='xt' href='https://swiftinit.org/hist/hummingbird:2.6.2/hummingbirdcore/response' target='_blank' rel='external'>Response</a> <span class='xk'>in</span><span class='newline'>
</span>        <span class='xk'>struct</span> <span class='xv'>CreatePostRequest</span>: <a class='xt' href='https://swiftinit.org/docs/swift/swift/codable' target='_blank' rel='external'>Codable</a> {<span class='newline'>
</span>            <span class='xk'>let</span> <span class='xv'>author</span>: <a class='xt' href='https://swiftinit.org/docs/swift/swift/string' target='_blank' rel='external'>String</a><span class='newline'>
</span>            <span class='xk'>let</span> <span class='xv'>content</span>: <a class='xt' href='https://swiftinit.org/docs/swift/swift/string' target='_blank' rel='external'>String</a><span class='newline'>
</span>        }<span class='newline'>
</span>        <span class='xk'>let</span> <span class='xv'>post</span> = <span class='xk'>try</span> <span class='xk'>await</span> <span class='xv'>request</span>.<a class='xv' href='https://swiftinit.org/hist/hummingbird:2.6.2/hummingbirdcore/request.decode(as:context:)' target='_blank' rel='external'>decode</a>(<span class='xv'>as</span>: <span class='xv'>CreatePostRequest</span>.<span class='xk'>self</span>, <span class='xv'>context</span>: <span class='xv'>context</span>)<span class='newline'>
</span>        <span class='xk'>try</span> <span class='xk'>await</span> <span class='xv'>createPost</span>(<span class='xv'>author</span>: <span class='xv'>post</span>.<span class='xv'>author</span>, <span class='xv'>content</span>: <span class='xv'>post</span>.<span class='xv'>content</span>, <span class='xv'>in</span>: <span class='xv'>db</span>)<span class='newline'>
</span>        <span class='xk'>return</span> <a class='xt' href='https://swiftinit.org/hist/hummingbird:2.6.2/hummingbirdcore/response' target='_blank' rel='external'>Response</a>(<span class='xv'>status</span>: .<a class='xv' href='https://swiftinit.org/docs/swift-http-types/httptypes/httpresponse/status.created' target='_blank' rel='external'>created</a>)<span class='newline'>
</span>    }<span class='newline'>
</span>}</code></pre><a rel='ugc' href='https://github.com/swift-on-server/articles/blob/main/Snippets/realtime-mongodb-app.swift#L33' target='_blank' class='source github'><span class='file'>realtime-mongodb-app.swift</span>:<span class='line'>33</span></a><p>This snippet adds a POST route to the application that creates a new post in the database. That process then triggers the change streams, which broadcast to all connected clients.</p><h2 id='Testing%20the%20Setup'><a href='#Testing%20the%20Setup'>Testing the Setup</a></h2><ol><li><p>Start the server:</p></li></ol><pre class='snippet'><code class='language-bash'><span class='newline'></span>swift run</code></pre><p>You can also copy the code from this tutorial’s snippet into your project and run it.</p><ol><li><p>Connect to the WebSocket endpoint:</p></li></ol><pre class='snippet'><code><span class='newline'></span>ws://localhost:8080</code></pre><ol><li><p>Create a new post using curl:</p></li></ol><pre class='snippet'><code class='language-bash'><span class='newline'></span>curl -X POST http://localhost:8080/posts \<span class='newline'>
</span>  -H "Content-Type: application/json" \<span class='newline'>
</span>  -d '{"author":"Joannis Orlandos","content":"Hello, real-time world!"}'</code></pre><p>You should see the new post appear immediately in your WebSocket client!</p><h2 id='Next%20Steps'><a href='#Next%20Steps'>Next Steps</a></h2><p>You’ve learned how to create a real-time feed of MongoDB changes using ChangeStreams and WebSockets! Here’s what you can explore next:</p><ul><li><p>Add authentication for both HTTP and WebSocket endpoints</p></li><li><p>Implement filters for specific types of changes</p></li><li><p>Add support for updates and deletions</p></li><li><p>Implement message acknowledgment</p></li><li><p>Add retry mechanisms for failed broadcasts</p></li></ul><h3 id='Resources'><a href='#Resources'>Resources</a></h3><ul><li><p><a href='https://www.mongodb.com/docs/manual/changeStreams/' target='_blank' rel='external nofollow noopener ugc'>MongoDB ChangeStreams Documentation</a></p></li><li><p><a href='https://github.com/hummingbird-project/hummingbird-websocket' target='_blank' rel='external'>Hummingbird WebSocket Documentation</a></p></li><li><p><a href='https://github.com/orlandos-nl/MongoKitten' target='_blank' rel='external'>MongoKitten Documentation</a></p></li></ul></section><div style='display: none;' id='swiftinit-tooltips'><a href='/hist/swift-on-server.articles:main/articles/getting-started-with-mongokitten'><p><a>MongoDB</a> is a popular NoSQL database that stores data in flexible, JSON-like documents. <a>MongoKitten</a> provides a Swift-native way to interact with MongoDB, complete with type-safe queries and Codable support.</p></a><a href='/hist/swift-on-server.articles:main/articles/websockets-tutorial-using-swift-and-hummingbird'><p>In this article, you will learn about WebSockets and how to use them with the Hummingbird framework in a straightforward, easy-to-follow manner. The first part will give a clear understanding of what the WebSocket protocol is. After that, a hands-on example will be created using the Hummingbird WebSocket library, showing how to use this technology effectively.</p></a><a href='/hist/mongokitten:7.9.8/mongokitten/mongodatabase'><pre><code><span class='xk'>class</span> <span class='xv'>MongoDatabase</span></code></pre><p>A reference to a MongoDB database, over a <code>MongoConnectionPool</code>.</p></a><a href='/docs/swift/foundationessentials/uuid'><pre><code><span class='xk'>struct</span> <span class='xv'>UUID</span></code></pre><p>Represents UUID strings, which can be used to uniquely identify types, interfaces, and other items.</p></a><a href='/hist/swift-websocket:1.2.1/wscore/websocketoutboundwriter'><pre><code><span class='xk'>struct</span> <span class='xv'>WebSocketOutboundWriter</span></code></pre><p>Outbound websocket writer</p></a><a href='/docs/swift/foundationessentials/data'><pre><code><span class='xa'>@frozen</span> <span class='xk'>struct</span> <span class='xv'>Data</span></code></pre></a><a href='/docs/swift/swift/string'><pre><code><span class='xa'>@frozen</span> <span class='xk'>struct</span> <span class='xv'>String</span></code></pre><p>A Unicode string value that is a collection of characters.</p></a><a href='/docs/swift/swift/string/encoding.utf8'><pre><code><span class='xk'>static</span> <span class='xk'>let</span> <span class='xv'>utf8</span>: <span class='xt'>String</span>.<span class='xt'>Encoding</span></code></pre></a><a href='/docs/swift/swift/dictionary.values'><pre><code><span class='xk'>var</span> <span class='xv'>values</span>: <span class='xt'>Dictionary</span>&lt;<span class='xt'>Key</span>, <span class='xt'>Value</span>&gt;.<span class='xt'>Values</span> { <span class='xk'>get</span> <span class='xk'>set</span> }</code></pre><p>A collection containing just the values of the dictionary.</p></a><a href='/hist/swift-websocket:1.2.1/wscore/websocketoutboundwriter.write(_:)'><pre><code><span class='xk'>func</span> <span class='xv'>write</span>(<span class='xi'></span>_ <span class='xb'>frame</span>: <span class='xt'>OutboundFrame</span><wbr>) <span class='xk'>async</span> <span class='xk'>throws</span></code></pre><p>Write WebSocket frame</p></a><a href='/hist/swift-websocket:1.2.1/wscore/websocketoutboundwriter/outboundframe.text(_:)'><pre><code><span class='xk'>case</span> <span class='xv'>text</span>(<span class='xt'>String</span>)</code></pre><p>Text frame</p></a><a href='/docs/swift/swift/sendable'><pre><code><span class='xk'>protocol</span> <span class='xv'>Sendable</span></code></pre></a><a href='/docs/swift/swift/dictionary.subscript(_:)?hash=8RFQL'><pre><code><span class='xk'>subscript</span>(<span class='xi'></span><span class='xv'>key</span>: <span class='xt'>Key</span><wbr>) -&gt; <span class='xt'>Value</span>? { <span class='xk'>get</span> <span class='xk'>set</span> }</code></pre><p>Accesses the value associated with the given key for reading and writing.</p></a><a href='/hist/swift-service-lifecycle:2.6.3/servicelifecycle/service'><pre><code><span class='xk'>protocol</span> <span class='xv'>Service</span> : <span class='xt'>Sendable</span></code></pre><p>This is the basic protocol that a service has to implement.</p></a><a href='/hist/mongokitten:7.9.8/mongokitten/mongodatabase.subscript(_:)'><pre><code><span class='xk'>subscript</span>(<span class='xi'></span><span class='xv'>collection</span>: <span class='xt'>String</span><wbr>) -&gt; <span class='xt'>MongoCollection</span> { <span class='xk'>get</span> }</code></pre><p>Get a collection in this database</p></a><a href='/hist/mongokitten:7.9.8/mongokitten/mongocollection.watch(options:type:using:)'><pre><code><span class='xk'>func</span> <span class='xv'>watch</span>&lt;<span class='xu'>T</span>&gt;(<span class='xi'></span><span class='xv'>options</span>: <span class='xt'>ChangeStreamOptions</span> = .<span class='xk'>init</span>(), <span class='xi'></span><span class='xv'>type</span>: <span class='xt'>T</span>.<span class='xk'>Type</span>, <span class='xi'></span><span class='xv'>using</span> <span class='xb'>decoder</span>: <span class='xt'>BSONDecoder</span> = <span class='xv'>BSONDecoder</span>()<wbr>) <span class='xk'>async</span> <span class='xk'>throws</span> -&gt; <span class='xt'>ChangeStream</span>&lt;<span class='xt'>T</span>&gt; <span class='xk'>where</span> <span class='xt'>T</span> : <span class='xt'>Decodable</span></code></pre><p>Creates a type-safe change stream for this collection</p></a><a href='/hist/mongokitten:7.9.8/mongokitten/changestreamnotification.operationtype'><pre><code><span class='xk'>let</span> <span class='xv'>operationType</span>: <span class='xt'>OperationType</span></code></pre><p>The type of operation that caused this notification</p></a><a href='/docs/swift/swift.==(_:_:)?hash=9HU5C'><pre><code><span class='xk'>func</span> <span class='xo'>==</span> &lt;<span class='xu'>T</span>&gt;(<span class='xi'></span><span class='xv'>lhs</span>: <span class='xt'>T</span>, <span class='xi'></span><span class='xv'>rhs</span>: <span class='xt'>T</span><wbr>) -&gt; <span class='xt'>Bool</span> <span class='xk'>where</span> <span class='xt'>T</span> : <span class='xt'>RawRepresentable</span>, <span class='xt'>T</span>.<span class='xt'>RawValue</span> : <span class='xt'>Equatable</span></code></pre><p>Returns a Boolean value indicating whether the two arguments are equal.</p></a><a href='/hist/mongokitten:7.9.8/mongokitten/changestreamnotification/operationtype.insert'><pre><code><span class='xk'>case</span> <span class='xv'>insert</span></code></pre></a><a href='/hist/mongokitten:7.9.8/mongokitten/changestreamnotification.fulldocument'><pre><code><span class='xk'>let</span> <span class='xv'>fullDocument</span>: <span class='xt'>T</span>?</code></pre><p>The full document that was changed</p></a><a href='/docs/swift/foundationessentials/jsonencoder'><pre><code><span class='xk'>class</span> <span class='xv'>JSONEncoder</span></code></pre><p><code>JSONEncoder</code> facilitates the encoding of <code>Encodable</code> values into JSON.</p></a><a href='/docs/swift/foundationessentials/jsonencoder.encode(_:)'><pre><code><span class='xk'>func</span> <span class='xv'>encode</span>&lt;<span class='xu'>T</span>&gt;(<span class='xi'></span>_ <span class='xb'>value</span>: <span class='xt'>T</span><wbr>) <span class='xk'>throws</span> -&gt; <span class='xt'>Data</span> <span class='xk'>where</span> <span class='xt'>T</span> : <span class='xt'>Encodable</span></code></pre><p>Encodes the given top-level value and returns its JSON representation.</p></a><a href='/hist/mongokitten:7.9.8/mongokitten/mongodatabase.connect(to:logger:)?hash=33E0S'><pre><code><span class='xk'>static</span> <span class='xk'>func</span> <span class='xv'>connect</span>(<span class='xi'></span><span class='xv'>to</span> <span class='xb'>uri</span>: <span class='xt'>String</span>, <span class='xi'></span><span class='xv'>logger</span>: <span class='xt'>Logger</span> = <span class='xv'>Logger</span>(<span class='xv'>label</span>: <span class='xs'>"org.orlandos-nl.mongokitten"</span>)<wbr>) <span class='xk'>async</span> <span class='xk'>throws</span> -&gt; <span class='xt'>MongoDatabase</span></code></pre><p>Connect to a MongoDB database using a connection string</p></a><a href='/hist/hummingbird:2.6.2/hummingbird/router'><pre><code><span class='xk'>final</span> <span class='xk'>class</span> <span class='xv'>Router</span>&lt;<span class='xu'>Context</span>&gt; <span class='xk'>where</span> <span class='xt'>Context</span> : <span class='xt'>RequestContext</span></code></pre><p>Create rules for routing requests and then create <code>Responder</code> that will follow these rules.</p></a><a href='/hist/hummingbird:2.6.2/hummingbird/basicrequestcontext'><pre><code><span class='xk'>struct</span> <span class='xv'>BasicRequestContext</span></code></pre><p>Implementation of a basic request context that supports everything the Hummingbird library needs</p></a><a href='/hist/hummingbird:2.6.2/hummingbird/application'><pre><code><span class='xk'>struct</span> <span class='xv'>Application</span>&lt;<span class='xu'>Responder</span>&gt; <span class='xk'>where</span> <span class='xt'>Responder</span> : <span class='xt'>HTTPResponder</span>, <span class='xt'>Responder</span>.<span class='xt'>Context</span> : <span class='xt'>InitializableFromSource</span>, <span class='xt'>Responder</span>.<span class='xt'>Context</span>.<span class='xt'>Source</span> <span class='xo'>==</span> <span class='xt'>ApplicationRequestContextSource</span></code></pre><p>Application class. Brings together all the components of Hummingbird together</p></a><a href='/docs/hummingbird-websocket/hummingbirdcore/httpserverbuilder.http1websocketupgrade(configuration:additionalchannelhandlers:shouldupgrade:)?hash=6SIVA'><pre><code><span class='xk'>static</span> <span class='xk'>func</span> <span class='xv'>http1WebSocketUpgrade</span>(<span class='xi'></span><span class='xv'>configuration</span>: <span class='xt'>WebSocketServerConfiguration</span> = .<span class='xk'>init</span>(), <span class='xi'></span><span class='xv'>additionalChannelHandlers</span>: <span class='xa'>@autoclosure</span> <span class='xa'>@escaping</span> () -&gt; [<span class='xk'>any</span> <span class='xt'>RemovableChannelHandler</span>] = [], <span class='xi'></span><span class='xv'>shouldUpgrade</span>: <span class='xa'>@escaping</span> (<span class='xt'>HTTPRequest</span>, <span class='xt'>Channel</span>, <span class='xt'>Logger</span>) <span class='xk'>throws</span> -&gt; <span class='xt'>ShouldUpgradeResult</span>&lt;<span class='xt'>WebSocketDataHandler</span>&lt;<span class='xt'>HTTP1WebSocketUpgradeChannel</span>.<span class='xt'>Context</span>&gt;&gt;<wbr>) -&gt; <span class='xt'>HTTPServerBuilder</span></code></pre><p>HTTP1 channel builder supporting a websocket upgrade</p></a><a href='/docs/hummingbird-websocket/hummingbirdwebsocket/shouldupgraderesult.upgrade(_:_:)'><pre><code><span class='xk'>case</span> <span class='xv'>upgrade</span>(_: <span class='xt'>HTTPFields</span> = [:], <span class='xt'>Value</span>)</code></pre></a><a href='/hist/hummingbird:2.6.2/hummingbird/application.addservices(_:)'><pre><code><span class='xk'>mutating</span> <span class='xk'>func</span> <span class='xv'>addServices</span>(<span class='xi'></span>_ <span class='xb'>services</span>: <span class='xk'>any</span> <span class='xt'>Service</span>...<wbr>)</code></pre><p>Add service to be managed by application ServiceGroup</p></a><a href='/hist/hummingbird:2.6.2/hummingbird/applicationprotocol.runservice(gracefulshutdownsignals:)'><pre><code><span class='xk'>func</span> <span class='xv'>runService</span>(<span class='xi'></span><span class='xv'>gracefulShutdownSignals</span>: [<span class='xt'>UnixSignal</span>] = [.<span class='xv'>sigterm</span>, .<span class='xv'>sigint</span>]<wbr>) <span class='xk'>async</span> <span class='xk'>throws</span></code></pre><p>Helper function that runs application inside a ServiceGroup which will gracefully shutdown on signals SIGINT, SIGTERM</p></a><a href='/hist/hummingbird:2.6.2/hummingbird/routermethods.post(_:use:)'><pre><code><span class='xa'>@discardableResult</span> <span class='xk'>func</span> <span class='xv'>post</span>(<span class='xi'></span>_ <span class='xb'>path</span>: <span class='xt'>RouterPath</span> = <span class='xs'>""</span>, <span class='xi'></span><span class='xv'>use</span> <span class='xb'>handler</span>: <span class='xa'>@escaping</span> (<span class='xt'>Request</span>, <span class='xt'>Context</span>) <span class='xk'>async</span> <span class='xk'>throws</span> -&gt; <span class='xk'>some</span> <span class='xt'>ResponseGenerator</span><wbr>) -&gt; <span class='xk'>Self</span></code></pre><p>POST path for async closure returning type conforming to ResponseGenerator</p></a><a href='/hist/hummingbird:2.6.2/hummingbird/routerpath.init(stringliteral:)'><pre><code><span class='xk'>init</span>(<span class='xi'></span><span class='xv'>stringLiteral</span> <span class='xb'>value</span>: <span class='xt'>String</span><wbr>)</code></pre><p>Initialize RouterPath from String literal</p></a><a href='/hist/hummingbird:2.6.2/hummingbirdcore/response'><pre><code><span class='xk'>struct</span> <span class='xv'>Response</span></code></pre><p>Holds all the required to generate a HTTP Response</p></a><a href='/docs/swift/swift/codable'><pre><code><span class='xk'>typealias</span> <span class='xv'>Codable</span> = <span class='xt'>Decodable</span> <span class='xo'>&amp;</span> <span class='xt'>Encodable</span></code></pre><p>A type that can convert itself into and out of an external representation.</p></a><a href='/hist/hummingbird:2.6.2/hummingbirdcore/request.decode(as:context:)'><pre><code><span class='xk'>func</span> <span class='xv'>decode</span>&lt;<span class='xu'>Type</span>&gt;(<span class='xi'></span><span class='xv'>as</span> <span class='xb'>type</span>: <span class='xt'>Type</span>.<span class='xk'>Type</span>, <span class='xi'></span><span class='xv'>context</span>: <span class='xk'>some</span> <span class='xt'>RequestContext</span><wbr>) <span class='xk'>async</span> <span class='xk'>throws</span> -&gt; <span class='xt'>Type</span> <span class='xk'>where</span> <span class='xt'>Type</span> : <span class='xt'>Decodable</span></code></pre><p>Decode request using decoder stored at <code>Application.decoder</code>.</p></a><a href='/docs/swift-http-types/httptypes/httpresponse/status.created'><pre><code><span class='xk'>static</span> <span class='xk'>var</span> <span class='xv'>created</span>: <span class='xt'>`Self`</span> { <span class='xk'>get</span> }</code></pre><p>201 Created</p></a></div>
                    
                </section>
    
                <footer>
                    <br>
                    <time datetime=""></time>
    
                    
                    <div class="author-list">
                        <a href="https://swiftonserver.com/authors/joannis-orlandos/">
                        <img class="small rounded" src="https://swiftonserver.com/assets/authors/joannis-orlandos/joannis-orlandos.jpeg" alt="Joannis Orlandos">
                        <span class="name">Joannis Orlandos</span>
                        </a>
                    </div>
                    <div class="tag-list">
                        <a href="https://swiftonserver.com/tags/databases/"><small>Databases</small></a>
                    <a href="https://swiftonserver.com/tags/hummingbird/"><small>Hummingbird</small></a>
                    </div>
                </footer>
                            
                <section class="group">
                    <h4>Related posts</h4>                
                    <div class="grid grid-221">
                        <div class="card featured">
                            <span class="featured">featured</span>
                            
                            <div class="author-list">
                                <a href="https://swiftonserver.com/authors/joannis-orlandos/">
                                <img class="small rounded" src="https://swiftonserver.com/assets/authors/joannis-orlandos/joannis-orlandos.jpeg" alt="Joannis Orlandos">
                                </a>
                            </div>
                            <div class="meta">
                                <time datetime="2024-09-24">2024-09-24</time>
                                    &middot; <span class="reading-time">7 min read</span>
                            </div>
                            
                            <h2 class="title"><a href="https://swiftonserver.com/getting-started-with-hummingbird/" target="">Getting Started with Hummingbird</a></h2>
                            <p>Learn how to get started with Hummingbird 2, the modern Swift Web Framework.</p>
                        
                            <div class="spacer"></div>
                        
                            <div class="tag-list">
                                <a href="https://swiftonserver.com/tags/hummingbird/"><small>Hummingbird</small></a>
        <a href="https://swiftonserver.com/tags/server/"><small>Server</small></a>
                            </div>
                        </div>
                    <div class="card">
                            
                            
                            <div class="author-list">
                                <a href="https://swiftonserver.com/authors/joannis-orlandos/">
                                <img class="small rounded" src="https://swiftonserver.com/assets/authors/joannis-orlandos/joannis-orlandos.jpeg" alt="Joannis Orlandos">
                                </a>
                            </div>
                            <div class="meta">
                                <time datetime="2024-12-28">2024-12-28</time>
                                    &middot; <span class="reading-time">8 min read</span>
                            </div>
                            
                            <h2 class="title"><a href="https://swiftonserver.com/getting-started-with-mongokitten/" target="">Getting Started with MongoKitten</a></h2>
                            <p>Learn how to get started with MongoDB using MongoKitten</p>
                        
                            <div class="spacer"></div>
                        
                            <div class="tag-list">
                                <a href="https://swiftonserver.com/tags/databases/"><small>Databases</small></a>
                            </div>
                        </div>
                    <div class="card">
                            
                            
                            <div class="author-list">
                                <a href="https://swiftonserver.com/authors/joannis-orlandos/">
                                <img class="small rounded" src="https://swiftonserver.com/assets/authors/joannis-orlandos/joannis-orlandos.jpeg" alt="Joannis Orlandos">
                                </a>
                            </div>
                            <div class="meta">
                                <time datetime="2024-09-30">2024-09-30</time>
                                    &middot; <span class="reading-time">9 min read</span>
                            </div>
                            
                            <h2 class="title"><a href="https://swiftonserver.com/how-to-build-a-proxy-server-with-hummingbird/" target="">How to Build a Proxy Server with Hummingbird</a></h2>
                            <p>Learn how to leverage the flexibility and performance of Hummingbird to build a proxy server.</p>
                        
                            <div class="spacer"></div>
                        
                            <div class="tag-list">
                                <a href="https://swiftonserver.com/tags/hummingbird/"><small>Hummingbird</small></a>
        <a href="https://swiftonserver.com/tags/server/"><small>Server</small></a>
                            </div>
                        </div>
                    <div class="card">
                            
                            
                            <div class="author-list">
                                <a href="https://swiftonserver.com/authors/joannis-orlandos/">
                                <img class="small rounded" src="https://swiftonserver.com/assets/authors/joannis-orlandos/joannis-orlandos.jpeg" alt="Joannis Orlandos">
                                </a>
                            </div>
                            <div class="meta">
                                <time datetime="2025-01-20">2025-01-20</time>
                                    &middot; <span class="reading-time">3 min read</span>
                            </div>
                            
                            <h2 class="title"><a href="https://swiftonserver.com/hummingbird-and-cors/" target="">Hummingbird and CORS</a></h2>
                            <p>Learn how to use Hummingbird and CORS in Swift</p>
                        
                            <div class="spacer"></div>
                        
                            <div class="tag-list">
                                <a href="https://swiftonserver.com/tags/hummingbird/"><small>Hummingbird</small></a>
        <a href="https://swiftonserver.com/tags/server/"><small>Server</small></a>
                            </div>
                        </div>
                    <div class="card">
                            
                            
                            <div class="author-list">
                                <a href="https://swiftonserver.com/authors/joannis-orlandos/">
                                <img class="small rounded" src="https://swiftonserver.com/assets/authors/joannis-orlandos/joannis-orlandos.jpeg" alt="Joannis Orlandos">
                                </a>
                            </div>
                            <div class="meta">
                                <time datetime="2024-12-28">2024-12-28</time>
                                    &middot; <span class="reading-time">8 min read</span>
                            </div>
                            
                            <h2 class="title"><a href="https://swiftonserver.com/realtime-mongodb-updates-with-changestreams-and-websockets/" target="">Realtime MongoDB Updates with ChangeStreams and WebSockets</a></h2>
                            <p>Learn how to implement real-time updates over WebSockets using ChangeStreams and MongoKitten</p>
                        
                            <div class="spacer"></div>
                        
                            <div class="tag-list">
                                <a href="https://swiftonserver.com/tags/databases/"><small>Databases</small></a>
        <a href="https://swiftonserver.com/tags/hummingbird/"><small>Hummingbird</small></a>
                            </div>
                        </div>
                    <div class="card">
                            
                            
                            <div class="author-list">
                                <a href="https://swiftonserver.com/authors/joannis-orlandos/">
                                <img class="small rounded" src="https://swiftonserver.com/assets/authors/joannis-orlandos/joannis-orlandos.jpeg" alt="Joannis Orlandos">
                                </a>
                            </div>
                            <div class="meta">
                                <time datetime="2024-10-01">2024-10-01</time>
                                    &middot; <span class="reading-time">6 min read</span>
                            </div>
                            
                            <h2 class="title"><a href="https://swiftonserver.com/using-hummingbird-request-context/" target="">Using Hummingbird&#39;s Request Contexts</a></h2>
                            <p>Learn about request contexts in Hummingbird and how to use them.</p>
                        
                            <div class="spacer"></div>
                        
                            <div class="tag-list">
                                <a href="https://swiftonserver.com/tags/hummingbird/"><small>Hummingbird</small></a>
        <a href="https://swiftonserver.com/tags/server/"><small>Server</small></a>
                            </div>
                        </div>
                    </div>
                </section>
    
            </article>
        </div>
        
        <div>
            <div class="support">
                <a href="https://swiftcraft.uk/" target="_blank">
                    <img src="https://swiftonserver.com/images/logos/swiftcraft.png" alt="SwiftCraft logo">
                </a>
                <h4>
                    <a href="https://swiftcraft.uk/" target="_blank">SwiftCraft</a>
                </h4>
                <p>
                    SwiftCraft is a UK based Swift Conference, 19th-21st May 2025!
                    <br>
                    There'll be talks, workshops, and a lot of Swift (Server) fun!
                </p>
                <a class="cta" href="https://swiftcraft.uk/" target="_blank">Get Tickets</a>
            </div>
            
            <aside id="toc">
                <h4>On this page</h4>
                <ul>
                    <li class="first-level">
                        <a href="#Overview">Overview</a>
                        <ul>
                        </ul>
                    </li>
        <li class="first-level">
                        <a href="#Prerequisites">Prerequisites</a>
                        <ul>
                        </ul>
                    </li>
        <li class="first-level">
                        <a href="#The%20Connection%20Manager">The Connection Manager</a>
                        <ul>
                        </ul>
                    </li>
        <li class="first-level">
                        <a href="#">Tip</a>
                        <ul>
                        </ul>
                    </li>
        <li class="first-level">
                        <a href="#Watching%20for%20Changes">Watching for Changes</a>
                        <ul>
                        </ul>
                    </li>
        <li class="first-level">
                        <a href="#Setting%20Up%20the%20Application">Setting Up the Application</a>
                        <ul>
                        </ul>
                    </li>
        <li class="first-level">
                        <a href="#Adding%20Routes">Adding Routes</a>
                        <ul>
                        </ul>
                    </li>
        <li class="first-level">
                        <a href="#Testing%20the%20Setup">Testing the Setup</a>
                        <ul>
                        </ul>
                    </li>
        <li class="first-level">
                        <a href="#Next%20Steps">Next Steps</a>
                        <ul>
                        </ul>
                    </li>
        <li class="first-level">
                        <a href="#Resources">Resources</a>
                        <ul>
                        </ul>
                    </li>
                </ul>
            </aside>
    
        </div>
    </div>
    
    </main>

    <footer id="site-footer">
        <div class="grid grid-421">
    
            <figure>
                <picture>
                    <source
                        srcset="https://swiftonserver.com/images/logos/logo~dark.png"
                        media="(prefers-color-scheme: dark)"
                    >
                    <img
                        id="logo-image"
                        src="https://swiftonserver.com/images/logos/logo.png"
                        alt="Logo of Swift on server"
                        title="Swift on server"
                    >
                </picture>
            </figure>
            
            <div>
                <span style="display: block; height: 32px;">&nbsp;</span>
                <h4>Swift on server</h4>
                <p><small><a href="/" target="_blank">swiftonserver.com</a></small></p>
                <ul>
                    <li><a href="https://github.com/swift-on-server/" target="_blank">GitHub</a></li>
                    <li><a href="https://mastodon.social/@swiftonserver/" target="_blank">Mastodon</a></li>
                    <li><a href="/rss.xml" target="_blank">RSS</a></li>
                    <li><a href="/sitemap.xml" target="_blank">Sitemap</a></li>
                </ul>
            </div>
            
            <div>
                <a href="/authors/joannis-orlandos/">
                <img class="small rounded" src="https://swiftonserver.com/assets/authors/joannis-orlandos/joannis-orlandos.jpeg" alt="Joannis Orlandos">
                </a>
                <h4><a href="/authors/joannis-orlandos/">Joannis Orlandos</a></h4>
                <p><small><a href="https://unbeatable.software/" target="_blank">Unbeatable Software B.V.</a></small></p>
                <ul>
                    <li><a href="mailto:hello@unbeatable.software" target="_blank">Email</a></li>
                    <li><a href="https://github.com/Joannis" target="_blank">GitHub</a></li>
                    <li><a href="https://x.com/JoannisOrlandos" target="_blank">X (Twitter)</a></li>
                    <li><a href="https://mastodon.social/@joannis@fosstodon.org" target="_blank">Mastodon</a></li>
                </ul>
            </div>
            
            <div>
                <a href="/authors/tibor-bodecs/">
                <img class="small rounded" src="https://swiftonserver.com/assets/authors/tibor-bodecs/tibor-bodecs.jpeg" alt="Tibor Bödecs">
                </a>
                <h4><a href="/authors/tibor-bodecs/">Tibor Bödecs</a></h4>
                <p><small><a href="https://binarybirds.com/" target="_blank">Binary Birds Kft.</a></small></p>
                <ul>
                    <li><a href="mailto:mail.tib@gmail.com" target="_blank">Email</a></li>
                    <li><a href="https://github.com/tib/" target="_blank">GitHub</a></li>
                    <li><a href="https://x.com/tiborbodecs" target="_blank">X (Twitter)</a></li>
                    <li><a href="https://mastodon.social/@tiborbodecs" target="_blank">Mastodon</a></li>
                </ul>
            </div>
            
        </div>
        
        <section class="grid grid-221">
            <small>Swift on server &copy; 2022 - 2025</small>
            <small>This site was generated using <a href="https://swift.org/" target="_blank">Swift</a> & <a href="https://github.com/binarybirds/toucan" target="_blank">Toucan</a>.</small>
        </section>
    </footer>

    </div>

    

    <script type="text/javascript" src="/js/tooltips.js" async=""></script>
</body>
</html>
